# Oracle

## 安装

1. 将xp或者window2003虚拟机挂到虚拟机上

 3.将oracle安装包导到虚拟机安装

 4.填写口令，一定要备注设置密码，避免引起不必要的后面的登录

5.选择企业版，下一步，网络配置需求点上，下一步

6.点击口令管理将scott和HR用户取消

7.下一步，安装完成退出

8.给虚拟机设置网络配置

9.在虚拟机界面点击编辑，设置虚拟网络编辑器

10，选择仅主机模式，主机模式和NET模式的区别在于后者共用一个ip，前者两个，后者可以上网。

11.点击添加网络，应用，确定

12.到主机的网络连接适配器里找到设置好的网络适配器，修改该适配器的属性里的internet协议4的，双击打开，在ip地址后面设置一个数字，这个数字与虚拟机里要不相同，主机和虚拟机系统网址最后一位不同。

13.回到虚拟机里的系统，找到网络适配器，修改internet协议4的ip地址，使用下面的地址，此数字与之前在主机上设置的不同，打开网络连接在电脑的右下方的网络里快速配置

14.输入ip地址，点击确定

15.自定义虚拟机的网络适配器，点击虚拟机设置里，自定义好设置好的网络适配器，确定

16.修改oracle安装目录的两个文件，

![1560358101616](C:\Users\admin\AppData\Roaming\Typora\typora-user-images\1560358101616.png)

17.在该路径找这两个文件C:\oracle\product\10.2.0\db_2\NETWORK\ADMIN

18.修改打开方式为记事本，打开将里面的ip地址设置为虚拟机设置的ip地址，即在inter协议4修改的ip地址

19.重启oracle，在cmd里sqlplus启动，输入system,及安装时设置的口令，输入-shutdown immediate，重启，startup

20.从虚拟机复制tnsnames文件到主机目录下，设置环境变量，变量名TNS_ADMIN，属性值写文件路径，保存

21.主要连接不上是因为没有启动，所以用户登录不上

解决方法       

sqlplus/logno

conn/ as sysdba

以管理员身份登录，然后shutdown immedate  startup

# [Oracle 数据库启动与关闭 各种方式详解整理](https://www.cnblogs.com/fiberhome/p/7414220.html)



概述

只有具备sysdba和sysoper[系统](http://www.2cto.com/os/)特权的用户才能启动和关闭[数据库](http://www.2cto.com/database/)。

在启动数据库之前应该启动监听程序，否则就不能利用命令方式来管理数据库，包括启动和关闭数据库。

虽然数据库正常运行，但如果没有启动监听程序，客户端就不能连接到数据库。

在oracle用户下： 启动监听程序 lsnrctl start 关闭监听程序lsnrctl stop

查询监听程序状态lsnrctl status

startup

支持参数

STARTUP options | upgrade_options

options为：[FORCE] [RESTRICT] [PFILE=filename] [QUIET] [ MOUNT [dbname]

| [ OPEN [open_options] [dbname] ] | NOMOUNT ]，

NOMOUNT、MOUNT、OPEN为startup的三个阶段，不能在命令中同时存在。其中，open_options为：READ {ONLY

| WRITE [RECOVER]} | RECOVER。

upgrade_options为：[PFILE=filename] {UPGRADE | DOWNGRADE} [QUIET]

 

[Oracle](http://lib.csdn.net/base/oracle)[数据库](http://lib.csdn.net/base/mysql)的完整启动过程包含以下3个步骤：

简单地说，就是：**启动实例**-->**加载数据库**-->**打开数据库**.

\------------------------------------------------------------------------------------------------------------------

**1.创建并启动与数据库对应的实例。**

在启动实例时，将为实例创建一系列后台进程和服务进程，并且在内存中创建SGA区等内存结构。在实例启动的过程中只会使用到初始化参数文件，数据库是否存在对实例的启动没有影响。如果初化参数设置有误，实例将无法启动。

**2.为实例加载数据库。**

加载数据库时实例将打开数据库的控制文件，从控制文件中获取数据库名称、数据文件的位置和名称等有关数据库物理结构的信息，为打开数据库做好准备。如果控制文件损坏，则实例将无法加载数据库。在加载数据库阶段，实例并不会打开数据库的物理文件----数据文件和重做日志文件。

**3.将数据库设置为打开状态。**

打开数据库时，实例将打开所有处于联机状态的数据文件和重做日志文件。控制文件中的任何一个数据文件或重做日志文件无法正常打开，数据库都将返回错误信息，这时需要进行数据库恢复。

只有将数据库设置为打开状态后，数据库才处于正常状态，这时普通用户才能够访问数据库。在很多情况下，启动数据库时并不是直接完成上述3个步骤，而是逐步完成的，然后执行必要的管理操作，最后才使数据库进入正常运行状态。所以，才有了各种不同的启动模式用于不同的数据库维护操作。

因为Oracle数据库启动过程中不同的阶段可以对数据库进行不同的维护操作，对应我们不同的需求，所以就需不同的模式启动数据库。

小白：在启动实例之前，需要先启动SQL*Plus，并以一个用户身份连接到Oracle。

 

**启动模式详解**

**1.NoMount 模式（启动实例不加载数据库）**

命令：startup nomount

讲解：这种启动模式只会创建实例，并不加载数据库，Oracle仅为实例创建各种内存结构和服务进程，不会打开任何数据文件。在NoMount模式下，只能访问那些与SGA区相关的数据字典视图，包括V$PARAMETER、V$SGA、V$PROCESS 和 V$SESSION等，这些视图中的信息都是从SGA区中获取的，与数据库无关。非安装启动，这种方式启动下可执行:重建控制文件、重建数据库、读取init.ora文件，启动instance，即启动SGA和后台进程，这种启动只需要init.ora文件。

模式用途：

(1)创建新数据库；

(2)重建控制文件。

 

**2.Mount模式（加载数据库但不打开数据库）**

命令：startup mount

讲解：这种启动模式将为实例加载数据库，但保持数据库为关闭状态。因为加载数据库时需要打开数据库控制文件，但数据文件和重做日志文件都都无法进行读写，所以用户还无法对数据库进行操作。 在Mount模式下，只能访问那些与控制文件相关的数据字典视图，包括V$THREAD、V$CONTROLFILE、V$DATABASE、V$DATAFILE 和 V$LOGFILE等，这些视图都是从控制文件中获取的。

模式用途：

(1)重命名数据文件；

(2)添加、删除或重命名重做日志文件；

(3)执行数据库完全恢复操作；

(4)改变数据库的归档模式。

 

**3.Open模式（正常打开数据库）**

命令：startup [open]

讲解：正常按3个步骤启动数据库。

模式用途：平时不对数据库做什么维护，像只做应用开发，用这个模式就好了。

 

**4.强制启动模式**

命令：startup force

用途&讲解：在某些情况下，使用前面的各种模式都无法成功启动数据库时，可以尝试强制启动模式。

 

**使用Alter Database语句，还可以在各启动模式间切换。**并且，还可以对数据库设置不同的状态用于不同的操作，如受/非受限抽状态、只读。

 

**使用Alter Database语句，在各启动模式间切换。**

**(1)**从NoMount模式切换到Mount模式(没有从mount切换到nomount的)：

命令：ALTER DATABASE MOUNT;

 

**(2)**当[数据库](http://lib.csdn.net/base/mysql)状态为关闭时，切换到Open模式

命令：ALTER DATABASE OPEN;

 

**(3)**在Open模式下，还可以选择将数据库设置为非受限状态和受限状态。

命令：

在启动Open模式时，添加restrict关键字：startup restrict

设置或取消受限状态：alter system enable\disable restricted session;

讲解：

非受限状态，就是我们平时应用程序开发用到的状态。

**受限状态**，当打开的数据库被设置为受限状态时，只有Create Session 和 Restricted Session系统权限 或者 具有SYSDBA  和 SYSPORE 系统权限的用户才能连接到数据库。但进入受限状态后，系统中仍然可能会存在活动的普通用户会话。

受限状态用途：

(1)执行数据导入或导出操作；

(2)暂时拒绝普通用户访问数据库；

(3)进行数据库移植或升级操作。

 

**(4) 只读状态**

设置只读命令：alter database open read only;

取消只读命令：alter database open read write;

用途&讲解：当一个正常打开的数据库被设置为只读状态时，用户只能查询数据，但不能以任何方式对数据库对象进行修改。处于只读状态，可能保证数据文件和重做日志文件中的内容不被修改，但是并不限制那些不会写入数据文件与重做日志文件的操作。

 

**关闭数据库与实例**

 

与数据库启动一下，关闭数据库与实例也分为3步：**关闭数据库**-->**实例卸载数据库**--->**终止实例**。

(1)关闭数据库，oracle将重做日志高速缓存中的内容写入重做日志文件，并且将数据库高速缓存中被改动过的数据写入数据文件，然后再关闭所有的数据文件和重做日志文件，这时数据库的控制文件仍然处于打开状态，但是由于数据库处于关闭状态，所以用户无法访问数据库。

（2）卸载数据库，关闭数据库后，例程才能被卸载，控制文件再这个时候被关闭，但例程仍然存在 。

（3）终止例程，进程终止，分配给例程的内存sga区被回收。

**1.Nomal（正常关闭方式）**

命令：shutdown nomal

讲解：正常方式关闭数据时，Oracle执行如下操作：

(1)阻止任何用户建立新的连接。

(2)等待当前所有正在连接的用户主动断开连接（此方式下Oracle不会立即断掉当前用户的连接，这些用户仍然操作相关的操作）

(3)一旦所有的用户都断开连接，则立即关闭、卸载数据库，并终止实例。（所以，一般以正常方式关闭数据库时，应该通知所有在线的用户尽快断开连接）

 

**2.Immediate（立即关闭方式）**

命令：shutdown immediate

讲解：

(1)阻止任何用户建立新的连接，同时阻止当前连接的用户开始任何新的事务。

(2)Oracle不等待在线用户主动断开连接，强制终止用户的当前事务，将任何未提交的事务回退。（如果存在太多未提交的事务，此方式将会耗费很长时间终止和回退事务）

(3)直接关闭、卸载数据库，并终止实例。

 

**3.Transactional（事务关闭方式）**

命令：shutdown transactional

讲解：这种方式介于正常关闭方式跟立即关闭方式之间，响应时间会比较快，处理也将比较得当。执行过程如下：

 

(1)阻止任何用户建立新的连接，同时阻止当前连接的用户开始任何新的事务。

(2)等待所有未提交的活动事务提交完毕，然后立即断开用户的连接。

(3)直接关闭、卸载数据库，并终止实例。

 

**4.Abort（终止关闭方式）**

命令：shutdown abort

讲解：这是比较粗暴的一种关闭方式，当前面3种方式都无法关闭时，可以尝试使用终止方式来关闭数据库。但是以这种方式关闭数据库将会丢失一部份数据信息，当重新启动实例并打开数据库时，后台进程SMON会执行实例恢复操作。一般情况下，应当尽量避免使用这种方式来关闭数据库。执行过程如下：

 

(1)阻止任何用户建立新的连接，同时阻止当前连接的用户开始任何新的事务。

(2)立即终止当前正在执行的SQL语句。

(3)任何未提交的事务均不被退名。

(4)直接断开所有用户的连接，关闭、卸载数据库，并终止实例。

## PL/SQL安装

1.安装路径不能有空格

2.登录页面点cancel

3.到图形化界面点help，regit，用注册机破解该应用

4.点击tool-preference-









